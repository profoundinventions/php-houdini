<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Array Patterns &mdash; PHP Houdini  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Iterating Array Patterns" href="iterating-array-patterns.html" />
    <link rel="prev" title="Adding New Methods and Properties" href="adding-new-methods-and-properties.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> PHP Houdini
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="the-houdini-config-file.html">The Houdini Config File</a></li>
<li class="toctree-l1"><a class="reference internal" href="promoting-properties.html">Promoting Properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="promoting-methods.html">Promoting Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="filters.html">Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="transforms.html">Transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="adding-new-methods-and-properties.html">Adding New Methods and Properties</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Array Patterns</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#simple-array-patterns-example">Simple Array Patterns Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-match-method">The <code class="docutils literal notranslate"><span class="pre">match()</span></code> method</a></li>
<li class="toctree-l2"><a class="reference internal" href="#autocompleting-properties-example">Autocompleting Properties Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#combining-patterns-with-other-methods">Combining Patterns with other methods</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="iterating-array-patterns.html">Iterating Array Patterns</a></li>
<li class="toctree-l1"><a class="reference internal" href="support.html">Support or Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="list-of-filters.html">List of Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="list-of-transforms.html">List of Transforms</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PHP Houdini</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Array Patterns</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/array-patterns.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="array-patterns">
<h1>Array Patterns<a class="headerlink" href="#array-patterns" title="Permalink to this headline"></a></h1>
<p>In some projects, you may encounter classes that have complex specifications
of types inside of constants or properties.</p>
<p>Houdini can generate methods, constants, or properties from such definitions
using <em>Array Patterns</em></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The use of this is pretty specialized, and you don’t need it to use Houdini, which is why
it’s at the end of this tutorial. Feel free to <a class="reference internal" href="support.html"><span class="doc">skip array patterns</span></a>
if you don’t need it.</p>
</div>
<p>Array patterns parse the class definition, and then autocomplete methods or properties from
the default values based on patterns you describe in the <code class="docutils literal notranslate"><span class="pre">.houdini.php</span></code> file.</p>
<section id="simple-array-patterns-example">
<h2>Simple Array Patterns Example<a class="headerlink" href="#simple-array-patterns-example" title="Permalink to this headline"></a></h2>
<p>Each <code class="docutils literal notranslate"><span class="pre">ArrayPattern</span></code> is a fluent object that must have one or more calls to the <code class="docutils literal notranslate"><span class="pre">match()</span></code>
method in order to generate completions.</p>
<p>To create an <code class="docutils literal notranslate"><span class="pre">ArrayPattern</span></code>, you need to use the <code class="docutils literal notranslate"><span class="pre">ArrayPattern::create()</span></code> method. To use
it, you pass the pattern to the <code class="docutils literal notranslate"><span class="pre">-&gt;useArrayPattern</span></code> method.</p>
<p>Here’s a simple example of autocompleting a property from a specification inside an array:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text"><strong>array-pattern-example1.php</strong></span><a class="headerlink" href="#id1" title="Permalink to this code"></a></div>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">namespace</span> <span class="nx">SomeNamespace</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">SimpleArrayPatternExample</span> <span class="p">{</span>

   <span class="sd">/**</span>
<span class="sd">    * This static array defines the valid methods.</span>
<span class="sd">    */</span>
   <span class="k">protected</span> <span class="k">static</span> <span class="nv">$methodDefinitions</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">&#39;methodOne&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
      <span class="s1">&#39;methodTwo&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span>
   <span class="p">];</span>

   <span class="sd">/**</span>
<span class="sd">    * Where this class stores its data.</span>
<span class="sd">    */</span>
   <span class="k">protected</span> <span class="nv">$data</span> <span class="o">=</span> <span class="p">[];</span>

   <span class="k">public</span> <span class="k">function</span> <span class="fm">__call</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nx">self</span><span class="o">::</span><span class="nv">$methodDefinitions</span><span class="p">[</span><span class="nv">$name</span><span class="p">]))</span> <span class="p">{</span>
         <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">[</span><span class="nv">$name</span><span class="p">];</span>
      <span class="p">}</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text"><strong>.houdini.php</strong></span><a class="headerlink" href="#id2" title="Permalink to this code"></a></div>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">namespace</span> <span class="nx">Houdini\Config\V1</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">SomeNamespace\SimpleArrayPatternExample</span><span class="p">;</span>

<span class="nx">houdini</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">overrideClass</span><span class="p">(</span><span class="nx">SimpleArrayPatternExample</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">addNewMethods</span><span class="p">()</span>
    <span class="o">-&gt;</span><span class="na">fromPropertyOfTheSameClass</span><span class="p">(</span><span class="s1">&#39;methodDefinitions&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">fromContext</span><span class="p">(</span> <span class="nx">Context</span><span class="o">::</span><span class="na">isStatic</span><span class="p">()</span> <span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">useArrayPattern</span><span class="p">(</span>
         <span class="nx">ArrayPattern</span><span class="o">::</span><span class="na">create</span><span class="p">()</span>
         <span class="o">-&gt;</span><span class="na">match</span><span class="p">(</span> <span class="p">[</span> <span class="nx">ArrayPattern</span><span class="o">::</span><span class="na">NAME</span> <span class="o">=&gt;</span> <span class="nx">ArrayPattern</span><span class="o">::</span><span class="na">TYPE</span> <span class="p">]</span> <span class="p">)</span>
    <span class="p">);</span>
</pre></div>
</div>
</div>
<p>In this example, we’re autocompleting a method from a definition in the array stored
in the static property <code class="docutils literal notranslate"><span class="pre">$methodDefinitions</span></code>. The definition has to include
both the method name and the return type in for a completion match to be generated. The
name is matched with the <code class="docutils literal notranslate"><span class="pre">ArrayPattern::NAME</span></code> placeholder. Whatever is in the array will
be used in th completion.</p>
<p>Similarly, the <code class="docutils literal notranslate"><span class="pre">ArrayPattern::TYPE</span></code> placeholder will match the property type or the method return type.
In order for an array pattern to generate a completion, both the name and type have to be matched
(but see below for an exception to this).</p>
<p>So, in this example, two non-static methods will be autocompleted for the <code class="docutils literal notranslate"><span class="pre">SimpleArrayPatternExample</span></code>
instances.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We used a static property in the previous example as a source for the methods, but it could also have been
an instance property. In that case, you wouldn’t pass the <code class="docutils literal notranslate"><span class="pre">-&gt;fromContext(</span> <span class="pre">Context::isStatic()</span> <span class="pre">)</span></code>.
part.</p>
</div>
</section>
<section id="the-match-method">
<h2>The <code class="docutils literal notranslate"><span class="pre">match()</span></code> method<a class="headerlink" href="#the-match-method" title="Permalink to this headline"></a></h2>
<p>The argument passed to the <code class="docutils literal notranslate"><span class="pre">match</span></code> method is the one that is generating the completion.</p>
<p>There are two options to pass to <code class="docutils literal notranslate"><span class="pre">match</span></code>: a string or an array. In the previous example, we passed an array.
We’ll look at when you might want to pass a string later. When passing an array,
you can include arbitrary strings and arrays in the pattern to match the structure of how the method
name or return type are laid out in your method or property definition - just make sure to include
<code class="docutils literal notranslate"><span class="pre">ArrayPattern::NAME</span></code> or <code class="docutils literal notranslate"><span class="pre">ArrayPattern::TYPE</span></code> to get either the property type or the method return type.</p>
<p>When matching against an array value, the <code class="docutils literal notranslate"><span class="pre">match()</span></code> method looks only at the relevant
subset of the array - so an array can contain values not in the pattern and still match:</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">array-pattern-match-example.php</span><a class="headerlink" href="#id3" title="Permalink to this code"></a></div>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">namespace</span> <span class="nx">SomeNamespace</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">ArrayMatchExample</span> <span class="p">{</span>

   <span class="sd">/**</span>
<span class="sd">    * This static array defines the valid methods.</span>
<span class="sd">    */</span>
   <span class="k">protected</span> <span class="k">static</span> <span class="nv">$methodDefinitions</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">&#39;methodOne&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
         <span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
         <span class="s1">&#39;irrelevant_key&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;irrelevant_value&#39;</span><span class="p">,</span> <span class="c1">// match() will still work even with this set.</span>
      <span class="p">]</span>
   <span class="p">];</span>

   <span class="sd">/**</span>
<span class="sd">    * Where this class stores its data.</span>
<span class="sd">    */</span>
   <span class="k">protected</span> <span class="nv">$data</span> <span class="o">=</span> <span class="p">[];</span>

   <span class="k">public</span> <span class="k">function</span> <span class="fm">__call</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nx">self</span><span class="o">::</span><span class="nv">$methodDefinitions</span><span class="p">[</span><span class="nv">$name</span><span class="p">]))</span> <span class="p">{</span>
         <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">[</span><span class="nv">$name</span><span class="p">];</span>
      <span class="p">}</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">.houdini.php</span><a class="headerlink" href="#id4" title="Permalink to this code"></a></div>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">namespace</span> <span class="nx">Houdini\Config\V1</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">SomeNamespace\ArrayMatchExample</span><span class="p">;</span>

<span class="nx">houdini</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">overrideClass</span><span class="p">(</span><span class="nx">ArrayMatchExample</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">addNewMethods</span><span class="p">()</span>
    <span class="o">-&gt;</span><span class="na">fromPropertyOfTheSameClass</span><span class="p">(</span><span class="s1">&#39;methodDefinitions&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">fromContext</span><span class="p">(</span> <span class="nx">Context</span><span class="o">::</span><span class="na">isStatic</span><span class="p">()</span> <span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">useArrayPattern</span><span class="p">(</span>
         <span class="nx">ArrayPattern</span><span class="o">::</span><span class="na">create</span><span class="p">()</span>
         <span class="o">-&gt;</span><span class="na">match</span><span class="p">([</span>
            <span class="nx">ArrayPattern</span><span class="o">::</span><span class="na">NAME</span> <span class="o">=&gt;</span> <span class="p">[</span>
               <span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="nx">ArrayPattern</span><span class="o">::</span><span class="na">TYPE</span>
            <span class="p">]</span>
         <span class="p">])</span>
    <span class="p">);</span>
</pre></div>
</div>
</div>
</section>
<section id="autocompleting-properties-example">
<h2>Autocompleting Properties Example<a class="headerlink" href="#autocompleting-properties-example" title="Permalink to this headline"></a></h2>
<p>Hopefully that gives you an idea of what you can do with Array Patterns. Here’s a
similar example, that generates properties from constants:</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">array-pattern-property-constant-example.php</span><a class="headerlink" href="#id5" title="Permalink to this code"></a></div>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">namespace</span> <span class="nx">SomeNamespace</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">PropertyConstantExample</span> <span class="p">{</span>

   <span class="sd">/**</span>
<span class="sd">    * This static array defines the valid properties.</span>
<span class="sd">    */</span>
   <span class="k">const</span> <span class="no">PROPERTY_DEFINITIONS</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">&#39;propertyOne&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
      <span class="s1">&#39;propertyTwo&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span>
   <span class="p">];</span>

   <span class="sd">/**</span>
<span class="sd">    * Where this class stores its data.</span>
<span class="sd">    */</span>
   <span class="k">protected</span> <span class="nv">$data</span> <span class="o">=</span> <span class="p">[];</span>

   <span class="k">public</span> <span class="k">function</span> <span class="fm">__get</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nx">self</span><span class="o">::</span><span class="na">PROPERTY_DEFINITIONS</span><span class="p">[</span><span class="nv">$name</span><span class="p">]))</span> <span class="p">{</span>
         <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">[</span><span class="nv">$name</span><span class="p">];</span>
      <span class="p">}</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">.houdini.php</span><a class="headerlink" href="#id6" title="Permalink to this code"></a></div>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">namespace</span> <span class="nx">Houdini\Config\V1</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">SomeNamespace\ArrayPatternExample</span><span class="p">;</span>

<span class="nx">houdini</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">overrideClass</span><span class="p">(</span><span class="nx">PropertyConstantExample</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">addNewProperties</span><span class="p">()</span>
    <span class="o">-&gt;</span><span class="na">fromPropertyOfTheSameClass</span><span class="p">(</span><span class="s1">&#39;PROPERTY_DEFINITIONS&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">useArrayPattern</span><span class="p">(</span>
         <span class="nx">ArrayPattern</span><span class="o">::</span><span class="na">create</span><span class="p">()</span>
         <span class="o">-&gt;</span><span class="na">match</span><span class="p">(</span> <span class="p">[</span> <span class="nx">ArrayPattern</span><span class="o">::</span><span class="na">NAME</span> <span class="o">=&gt;</span> <span class="nx">ArrayPattern</span><span class="o">::</span><span class="na">TYPE</span> <span class="p">]</span> <span class="p">)</span>
    <span class="p">);</span>
</pre></div>
</div>
</div>
</section>
<section id="combining-patterns-with-other-methods">
<h2>Combining Patterns with other methods<a class="headerlink" href="#combining-patterns-with-other-methods" title="Permalink to this headline"></a></h2>
<p>For generating a completion, you need both a name and a type. So, you usually will want your array pattern
to include <code class="docutils literal notranslate"><span class="pre">ArrayPattern::NAME</span></code> and <code class="docutils literal notranslate"><span class="pre">ArrayPattern::TYPE</span></code>, but it’s also possible to only include
one of those and grab the other one from another method.</p>
<p>For example, you could grab the name from the ArrayPattern with <code class="docutils literal notranslate"><span class="pre">ArrayPattern::NAME</span></code>
and the return type with <code class="docutils literal notranslate"><span class="pre">useCustomType('string')</span></code>. Then, you’ll generate a new <code class="docutils literal notranslate"><span class="pre">string</span></code>
property for each <em>name</em> found in the array pattern.</p>
<p>Go to the <a class="reference internal" href="iterating-array-patterns.html"><span class="doc">next step</span></a> to learn about
adding methods or properties from specialized patterns of arrays.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="adding-new-methods-and-properties.html" class="btn btn-neutral float-left" title="Adding New Methods and Properties" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="iterating-array-patterns.html" class="btn btn-neutral float-right" title="Iterating Array Patterns" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Profound Inventions, LLC.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>